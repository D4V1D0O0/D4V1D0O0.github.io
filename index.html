<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saldo</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="label">Saldo</div>
        <div class="value" id="balance">Loading...</div>
        <div class="updated" id="updated">Updaterad: Loading...</div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <iframe width="402" height="346" frameborder="0" scrolling="no" src="https://studentbth-my.sharepoint.com/personal/dabr23_student_bth_se/_layouts/15/Doc.aspx?sourcedoc={3bcfbb86-6a1c-4637-8777-fc0afb3f1c13}&action=embedview&wdAllowInteractivity=False&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True"></iframe>
    <script>
        fetch('data.csv')
            .then(response => response.text())
            .then(data => {
                const workbook = XLSX.read(data, {type: 'string'});
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                // Assume first row: balance, second row: updated
                const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});
                const balance = rows[0][0];
                const updated = rows[1][0];
                document.getElementById('balance').textContent = balance + ' kr';
                document.getElementById('updated').textContent = 'Updaterad: ' + updated;
            })
            .catch(error => {
                console.error('Error loading CSV:', error);
                document.getElementById('balance').textContent = 'Error loading data';
                document.getElementById('updated').textContent = 'Error';
            });
    </script>
</body>
</html>
